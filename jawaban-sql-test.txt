1.	
SELECT 
C.CUST_ID, CONCAT(C.CUST_FIRSTNAME, ' ', C.CUST_LASTNAME) AS FULL_NAME,
COUNT(DISTINCT A.ACC_NUMBER) AS NUMBER_OF_ACCOUNTS
FROM CUSTOMER AS C
JOIN ACCOUNT AS A ON C.CUST_ID = A.ACC_OWNER
GROUP BY C.CUST_ID, C.CUST_FIRSTNAME, C.CUST_LASTNAME;

========================================================================

2.	 
SELECT
CONCAT(C.CUST_FIRSTNAME, ' ', C.CUST_LASTNAME) AS FULL_NAME,
CASE 
    WHEN T.TRS_TYPE = 'DB' THEN 'Debit' 
    WHEN T.TRS_TYPE = 'CR' THEN 'Credit' 
    WHEN T.TRS_TYPE = 'TF' THEN 'Money Transfer' 
END AS TRANSACTION_INFO
FROM CUSTOMER AS C
JOIN ACCOUNT AS A ON C.CUST_ID = A.ACC_OWNER
JOIN TRANSACTION AS T ON A.ACC_NUMBER = T.TRS_ID
WHERE CONCAT(C.CUST_FIRSTNAME, ' ', C.CUST_LASTNAME) = 'John Michael'
ORDER BY A.ACC_NUMBER DESC, T.TRS_DATE DESC;